
# 1 
int
xmlDecodeHex(
  unsigned char *out
 ,unsigned int olen
 ,const char *in
 ,unsigned int ilen
){
  static const unsigned char hex[] = {
    17, 17, 17, 17, 17, 17, 17, 17, 17, 16, 16, 17, 17, 16, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    16, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
     0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 17, 17, 17, 17, 17, 17,
    17, 10, 11, 12, 13, 14, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 10, 11, 12, 13, 14, 15, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17,
    17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17, 17
  };
  unsigned long buf;
  int len;

  buf = 1;
  len = 0;
  while (ilen-- > 0) {
    unsigned char c;

    switch ((c = hex[*(unsigned char*)in++])) {
    case 17:
      return (-1);
    case 16:
      continue;
    default:
      buf = buf << 4 | c;
      if (buf & 0x100) {
        if (olen > 0) {
          *out++ = buf;
          olen--;
        }
        len++;
        buf = 1;
      }
      break;
    }
  }
  if (buf != 1)
    return (-1);
  return (len);
}